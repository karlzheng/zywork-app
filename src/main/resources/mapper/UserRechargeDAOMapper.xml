<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="top.zywork.dao.UserRechargeDAO">

    <insert id="saveRechargeThirdParty">
        insert into t_funds_recharge(user_id, amount, recharge_type, out_trade_no, trade_no, is_success)
        values(#{userId}, #{amount}, #{rechargeType}, #{outTradeNo}, #{tradeNo}, #{isSuccess})
    </insert>

    <insert id="saveRechargeHuman">
        insert into t_funds_recharge(user_id, amount, recharge_type) values(#{userId}, #{amount}, '人工充值')
    </insert>

    <update id="updateWallet">
        update t_user_wallet set
        rmb_balance = rmb_balance + #{amount},
        usable_rmb_balance = usable_rmb_balance + #{amount},
        update_time = CURRENT_TIMESTAMP
        where id = #{userId}
    </update>

</mapper>
